{% if product and product != empty %}
    <div class='card-product__wrapper'>
        {%- assign video = product.media | where: 'media_type', 'video' -%}
        {% if video != blank %}
            <video-hover class='card-product__media-wrapper'>
                <div class='video-product video-product__size--{{ img_size }}'>
                    <div class='video-product__video video'>
                        {% for media in product.media %}
                            {% if media.media_type == 'video' %}
                                <video
                                    class='js-video video__media html5'
                                    title='{{ title | escape }}'
                                    playsinline
                                    loop
                                    muted
                                    disablePictureInPicture
                                    width='1440'
                                    controlsList='noplaybackrate nodownload'
                                >
                                    <source src='{{  media.sources[1].url  }}' type='video/mp4'>
                                </video>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <picture class='card-product__media media__size--{{ img_size }} media'>
                    {% if image_custom != blank %}
                        {% render 'image', image_box: image_custom, image_box_class: 'card-product__image' %}
                    {% else %}
                        {% render 'image', image_box: product.featured_media, image_box_class: 'card-product__image' %}
                    {% endif %}
                </picture>
            </video-hover>
        {% else %}
            <div class='card-product__media-wrapper '>
                <picture class='card-product__media media__size--{{ img_size }} media'>
                    {% if image_custom != blank %}
                        {% render 'image', image_box: image_custom, image_box_class: 'card-product__image' %}
                    {% else %}
                        {% render 'image', image_box: product.featured_media, image_box_class: 'card-product__image' %}
                    {% endif %}
                </picture>
            </div>
        {% endif %}
        <div class='card-product__content card-product__content--{{ fill }}'>
            <span class='visually-hidden'>{{ 'accessibility.vendor' | t }}</span>
            <span class='card-product__vendor'>{{ product.vendor }}</span>
            <h4 class='card-product__title'>
                <a href='{{ product.url | within: collection }}'>
                    {{ product.title | truncate: 30 | escape }}
                </a>
            </h4>
            {% render 'price', product: product, price_class: 'card-product__price', use_variant: use_variant %}

            {% if add_btn %}
                {% if btn == 'quick' %}
                    {% render 'form', product: product %}
                {% else %}
                    <a class='button button--secondary' href='{{ product.url | within: collection }}'>
                        {{- 'products.product.add_to_cart' | t -}}
                    </a>
                {% endif %}
            {% endif %}
        </div>
    </div>
{% endif %}
